{"version":3,"sources":["utils.ts","utils/escape.ts","Template.tsx","v1/en.jpeg","v1/zh.jpeg","v2/zh.jpeg","App.tsx","index.tsx"],"names":["formatLocationCode","str","replace","formatDisplayLocationCode","flow","chunk","map","arr","join","escapeHtml","html","text","document","createTextNode","p","createElement","appendChild","innerHTML","cssFrame","css","cssBgFrame","cssBg","cssQrCode","cssShopCode","cssSmsText","cssCount","App","img","classNameQrCode","classNameShopCode","classNameSmsText","classNameCount","history","useHistory","oriLocationCode","useParams","locationCode","cleanLocationCode","useMemo","useEffect","match","alert","length","fill","smsText","outFileName","split","useState","url","setUrl","cancel","QRCode","toDataURL","then","createMarkup","__html","className","onClick","e","toBlob","currentTarget","pixelRatio","blob","saveAs","cx","src","alt","dangerouslySetInnerHTML","undefined","children","style","color","Link","link","title","target","rel","to","Home","displayLocationCode","href","value","onChange","maxLength","placeholder","autoFocus","Redirect","basename","process","exact","sensitive","path","component","Template","v1Zh","v1En","v2Zh","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.98437683.chunk.js","sourcesContent":["import chunk from \"lodash/chunk\";\nimport flow from \"lodash/flow\";\n\nexport const formatLocationCode = (str: string) => str.replace(/[^\\d]/g, \"\");\nexport const formatDisplayLocationCode = (str: string) =>\n  flow(formatLocationCode, (str: string) =>\n    chunk(str, 4)\n      .map((arr) => arr.join(\"\"))\n      .join(\" \")\n  )(str);\n","const escapeHtml = (html: string) => {\n  var text = document.createTextNode(html);\n  var p = document.createElement(\"p\");\n  p.appendChild(text);\n  return p.innerHTML;\n};\n\nexport default escapeHtml;\n","import { css, cx } from \"@emotion/css\";\nimport { saveAs } from \"file-saver\";\nimport { toBlob } from \"html-to-image\";\nimport QRCode from \"qrcode\";\nimport { useEffect, useMemo, useState } from \"react\";\nimport { useHistory, useParams } from \"react-router-dom\";\nimport { formatDisplayLocationCode, formatLocationCode } from \"utils\";\nimport escapeHtml from \"utils/escape\";\n\nconst cssFrame = css`\n  label: cssFrame;\n  position: relative;\n`;\n\nconst cssBgFrame = css`\n  label: BgFrame;\n  width: fit-content;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  margin-right: auto;\n  margin-top: 0px;\n`;\n\nconst cssBg = css`\n  label: Bg;\n  /* height: 842px; */\n  width: 930px;\n  padding: 0;\n  margin-left: auto;\n  margin-right: auto;\n  z-index: 1;\n`;\n\nconst cssQrCode = css`\n  label: QrCode;\n  width: 300px;\n  height: 300px;\n  position: absolute;\n  top: 620px;\n  left: 155px;\n  z-index: 11;\n`;\n\nconst cssShopCode = css`\n  label: ShopCode;\n  position: absolute;\n  top: 990px;\n  left: 125px;\n  z-index: 11;\n  font-family: \"Courier New\", Courier, monospace;\n  font-size: 28px;\n  font-weight: 800;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  text-align: center;\n  width: 360px;\n  height: 57px;\n\n  outline: none;\n  border: 0;\n  padding: 0;\n  background: none;\n`;\n\nconst cssSmsText = css`\n  label: SmsText;\n  background: white;\n  position: absolute;\n  top: 621px;\n  left: 619px;\n  z-index: 11;\n  font-size: 10px;\n  font-weight: 800;\n  line-height: 1.5em;\n  letter-spacing: 1px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  text-align: left;\n  width: 181px;\n  height: 55px;\n  /* border: 1px solid red; */\n`;\n\nconst cssCount = css`\n  label: Count;\n  background: #fff;\n  position: absolute;\n  text-align: right;\n  padding: 2px;\n  top: 639px;\n  left: 800px;\n  font-size: 9px;\n  width: 26px;\n  height: 12px;\n  color: #d0d0d0;\n  z-index: 2;\n`;\n\nconst message = \"本簡訊是簡訊實聯制發送，限防疫目的使用。\";\n\nexport type AppProps = {\n  img: string;\n  classNameQrCode?: string;\n  classNameShopCode?: string;\n  classNameSmsText?: string;\n  classNameCount?: string;\n};\n\nfunction App({\n  img,\n  classNameQrCode,\n  classNameShopCode,\n  classNameSmsText,\n  classNameCount,\n}: AppProps) {\n  const history = useHistory();\n  const { locationCode: oriLocationCode } =\n    useParams<{ locationCode: string }>();\n  const cleanLocationCode = useMemo(\n    () => formatLocationCode(oriLocationCode),\n    [oriLocationCode]\n  );\n  useEffect(() => {\n    if (!oriLocationCode.match(/^\\d{15}$/)) {\n      alert(\"請輸入正確的場所代碼\");\n      history.replace(\"/\");\n    }\n  }, [cleanLocationCode.length, history, oriLocationCode]);\n  const locationCode = useMemo(\n    () => formatDisplayLocationCode(cleanLocationCode),\n    [cleanLocationCode]\n  );\n  const fill = locationCode.length === 18;\n  const smsText = useMemo(\n    () => (fill ? `場所代碼: ${locationCode}\\n${message}` : \"\"),\n    [fill, locationCode]\n  );\n  const outFileName = useMemo(\n    () => (fill ? `ays1922_${locationCode.split(\" \").join(\"-\")}.png` : \"\"),\n    [fill, locationCode]\n  );\n  const [url, setUrl] = useState(\"\");\n  useEffect(() => {\n    if (!fill) {\n      setUrl(\"\");\n      return;\n    }\n    let cancel = false;\n    QRCode.toDataURL(`smsto:1922:${smsText}`).then((url) => {\n      if (cancel) return;\n      setUrl(url);\n    });\n    return () => {\n      cancel = true;\n    };\n  }, [fill, locationCode, smsText]);\n  const createMarkup = useMemo(() => {\n    if (!fill) return undefined;\n    return () => ({\n      __html: smsText.split(\"\\n\").map(escapeHtml).join(\"<br/>\"),\n    });\n  }, [fill, smsText]);\n  return (\n    <div\n      className={cssFrame}\n      onClick={(e) => {\n        if (!fill) return;\n        toBlob(e.currentTarget, { pixelRatio: 1.5 }).then(function (blob) {\n          if (!blob) {\n            alert(\"Blob missing\");\n            return;\n          }\n          saveAs(blob, outFileName);\n          // history.replace(`/h/${cleanLocationCode}`);\n        });\n      }}\n    >\n      <div className={cssBgFrame}>\n        {url ? (\n          <img className={cx(cssQrCode, classNameQrCode)} src={url} alt=\"\" />\n        ) : null}\n      </div>\n      <div className={cx(cssCount, classNameCount)}>{smsText.length}/70</div>\n      <div className={cx(cssShopCode, classNameShopCode)}>{locationCode}</div>\n      {/* eslint-disable-next-line react/no-danger-with-children */}\n      <div\n        className={cx(cssSmsText, classNameSmsText)}\n        dangerouslySetInnerHTML={createMarkup ? createMarkup() : undefined}\n        children={\n          createMarkup ? undefined : (\n            <span style={{ color: \"red\" }}>請先輸入場所代碼</span>\n          )\n        }\n      />\n      <div className={cssBgFrame}>\n        <img className={cssBg} src={img} alt=\"\" />\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","export default __webpack_public_path__ + \"static/media/en.55753495.jpeg\";","export default __webpack_public_path__ + \"static/media/zh.d68bbc57.jpeg\";","export default __webpack_public_path__ + \"static/media/zh.2c3963f3.jpeg\";","import { css } from \"@emotion/css\";\nimport { Fragment, useEffect, useMemo } from \"react\";\nimport {\n  BrowserRouter,\n  NavLink,\n  Route,\n  Switch,\n  useHistory,\n  useParams,\n} from \"react-router-dom\";\nimport { formatDisplayLocationCode, formatLocationCode } from \"utils\";\nimport Template from \"./Template\";\nimport v1En from \"./v1/en.jpeg\";\nimport v1Zh from \"./v1/zh.jpeg\";\nimport v2Zh from \"./v2/zh.jpeg\";\n\nfunction Link({ link, title }: { link: string; title: string }) {\n  return (\n    <li>\n      <NavLink target=\"_blank\" rel=\"noopener noreferrer\" to={link}>\n        {title}\n      </NavLink>\n    </li>\n  );\n}\n\nfunction Home() {\n  const history = useHistory();\n  const { locationCode = \"\" } = useParams<{ locationCode: string }>();\n  const displayLocationCode = useMemo(\n    () => formatDisplayLocationCode(locationCode),\n    [locationCode]\n  );\n  const cleanLocationCode = useMemo(\n    () => formatLocationCode(locationCode),\n    [locationCode]\n  );\n  const fill = displayLocationCode.length === 18;\n  return (\n    <div\n      className={css`\n        padding: 1em;\n        max-width: 500px;\n        margin-left: 2em;\n        margin-right: auto;\n      `}\n    >\n      <h1>AnonYmouS 1922 簡訊實聯制海報產生器</h1>\n      <a\n        href=\"https://github.com/VdustR/ays1922#readme\"\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n      >\n        軟體簡介\n      </a>\n      <h2>操作步驟</h2>\n      <ol>\n        <li>\n          {\"輸入\"}\n          <a\n            href=\"https://www.facebook.com/ey.gov.tw/posts/4480266808667830\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            {\"場所代碼\"}\n          </a>\n          {\": \"}\n          <input\n            value={displayLocationCode}\n            onChange={(e) => {\n              const str = formatLocationCode(e.target.value);\n              history.replace(`/h/${str}`);\n            }}\n            maxLength={18}\n            placeholder=\"XXXX XXXX XXXX XXX\"\n            autoFocus\n          />\n          <button\n            onClick={(e) => {\n              history.replace(\"/h\");\n            }}\n          >\n            Clear\n          </button>\n        </li>\n        {fill ? (\n          <li>\n            {\"選擇模板後列印\"}\n            <div\n              className={css`\n                font-size: 0.8em;\n              `}\n            >\n              或是左鍵點擊海報可以另存圖片(可能會延遲 2~3 秒)\n            </div>\n            <ul>\n              <Link title=\"v2 - 中文\" link={`/v2/zh/${cleanLocationCode}`} />\n              <li>\n                <NavLink\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  to={`/v1/zh/${cleanLocationCode}`}\n                >\n                  v1 - 中文\n                </NavLink>\n              </li>\n              <li>\n                <NavLink\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  to={`/v1/en/${cleanLocationCode}`}\n                >\n                  v1 - 英文\n                </NavLink>\n              </li>\n            </ul>\n            <h4>列印快捷鍵:</h4>\n            <ul>\n              <li>\n                Mac: <kbd>⌘</kbd> + <kbd>p</kbd>\n              </li>\n              <li>\n                Windows & Linux: <kbd>Ctrl</kbd> + <kbd>p</kbd>\n              </li>\n            </ul>\n          </li>\n        ) : (\n          <li\n            className={css`\n              color: red;\n            `}\n          >\n            請先輸入正確的場所代碼\n          </li>\n        )}\n      </ol>\n    </div>\n  );\n}\n\nfunction Redirect() {\n  const history = useHistory();\n  useEffect(() => {\n    history.replace(\"/h\");\n  }, [history]);\n  return <Fragment />;\n}\n\nfunction App() {\n  return (\n    <BrowserRouter basename={process.env.PUBLIC_URL}>\n      <Switch>\n        <Route exact sensitive path=\"/\" component={Redirect} />\n        <Route exact sensitive path=\"/h/:locationCode?\" component={Home} />\n        <Route exact sensitive path=\"/v1/zh/:locationCode\">\n          <Template img={v1Zh} />\n        </Route>\n        <Route exact sensitive path=\"/v1/en/:locationCode\">\n          <Template\n            img={v1En}\n            classNameQrCode={css`\n              top: 614px;\n              left: 140px;\n            `}\n            classNameSmsText={css`\n              top: 594px;\n            `}\n            classNameCount={css`\n              top: 613px;\n            `}\n            classNameShopCode={css`\n              top: 979px;\n              left: 111px;\n              width: 361px;\n              height: 55px;\n            `}\n          />\n        </Route>\n        <Route exact sensitive path=\"/v2/zh/:locationCode\">\n          <Template\n            img={v2Zh}\n            classNameQrCode={css`\n              width: 193px;\n              height: 193px;\n              top: 573px;\n              left: 369px;\n            `}\n            classNameSmsText={css`\n              top: 998px;\n              left: 67px;\n              width: 164px;\n              height: 47px;\n            `}\n            classNameCount={css`\n              top: 1011px;\n              left: 226px;\n            `}\n            classNameShopCode={css`\n              top: 801px;\n              left: 336px;\n              width: 260px;\n              height: 37px;\n              font-size: 20px;\n            `}\n          />\n        </Route>\n        <Route path=\"/\">NOT FOUND!</Route>\n      </Switch>\n    </BrowserRouter>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport \"./fonts/fonts.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}